# CHAP03. 역할, 책임, 협력

## 키워드

협력, 메시지, 책임 할당, 행동, 역할, 추상화

<br>

## 요약

개별 객체의 상태나 행동이 아니라, 시스템의 기능을 구현하기 위한 협력에 초점을 맞춰야 훌륭한 책임을 찾을 수 있다. 수확된 책임과 관련된 정보를 가장 많이 알고 있는 객체에게 그 책임을 할당해야 한다.  책임이 할당된 객체들은 우리가 익히 알고 있는 클래스를 이용해 구현되고 생성된다.

<br>

## 정리

### 객체지향의 본질 = 역할, 책임, 협력

- 객체지향은 협력하는 객체들의 공동체를 창조하는 것
- 객체지향 설계는 협력을 구성하기 위해 적절한 객체를 찾고, 객체에 적절한 책임과 역할을 할당하는 과정
- 필요한 협력, 협력을 위해 필요한 역할과 책임이 어느정도 정립된 후 실제 구현에 들어가야 유연한 코드를 작성할 수 있다.

### 협력, 책임, 역할의 개념

**협력** : 객체들이 애플리케이션의 기능을 구현하기 위해 수행하는 상호작용

**책임** : 객체가 협력에 참여하기 위해 수행하는 로직

**역할** : 특정한 협력 안에서 객체가 수행하는 책임의 집합

### 객체는 협력을 위해 메시지를 주고받는다

- **메시지 전송**은 협력을 위해 객체가 사용할 수 있는 유일한 커뮤니케이션 수단
- 외부의 객체는 메시지만 전송, 메시지를 수신한 객체는 그 메시지를 자율적으로 처리한다.
- 객체는 자신에게 할당된 책임을 수행하던 중, (1) 필요한 정보가 없거나 (2) 외부의 도움이 필요한 경우 적절한 객체에 메시지를 전송하여 협력을 요청한다.

### 협력이 객체의 행동을 결정한다

- 어떤 객체의 행동을 결정하는 것은 객체가 참여하고 있는 협력이다.
- 협력은 객체가 필요한 이유와 객체가 수행하는 행동의 동기를 제공한다.
- ex) Movie : 일반적으로 상영과 관련된 행동을 수행할 것 같지만, 예제인 영화 예매 시스템 안의 Movie 객체는 ‘영화를 예매하기 위한 협력’에 참여하고 있고 ‘요금을 계산하는 책임’을 지고 있기 때문에 요금을 계산하는 메서드로 이루어져있다.

### 행동이 객체의 상태를 결정한다

- 객체의 상태는 그 객체가 행동을 수행하는 데 필요한 정보가 무엇인지로 결정된다.
- ex) Movie 는 ‘요금 계산’이라는 행동을 수행하기 때문에, 그에 필요한 기본 요금과 할인 정책 인스턴스 변수를 상태로 가지고 있다.

    ```jsx
    public class Movie {
        private Money fee;
        private DiscountPolicy discountPolicy;

        public Money calculateMovieFee() {} // 영화요금 계산 메서드
    }
    ```


### 아는 것과 하는 것의 책임

객체에게 할당할 책임은 두 가지 범주로 나뉜다.

1. 객체가 ‘아는 것’
    1. 사적인 정보에 관해 아는 것
    2. 관련된 객체에 관해 아는 것
    3. 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
2. 객체가 ‘하는 것’
    1. 객체를 생성하거나 계산을 하는 등, 스스로 하는 것
    2. 다른 객체의 행동을 시작시키는 것
    3. 다른 객체의 활동을 제어하고 조절하는 것
- ex) Screening 의 책임
- Screening 의 아는 것과 관련된 책임 : 자신이 상영할 영화를 알아야 한다. 고로 movie 인스턴스 변수를 가지고 있다.
- Screening 의 하는 것과 관련된 책임 : 영화를 예매할 수 있어야 한다. 고로 reserve 메시지를 수신할 수 있다.

### 책임 할당 = 전문가에게 맡기는 것

- 정보 전문가 패턴(Information expert) : 책임을 수행하는 데 필요한 정보를 가장 잘 알고 있는 객체(전문가)에게 그 책임을 할당하는 것
1. 협력(기능)에 필요한 메시지 정의
2. 메시지와 관련된 정보를 가장 많이 알고 있는 객체에게 책임 할당

이 두 가지 행위의 반복을 통해 객체지향 설계가 이루어진다.

### 책임 주도 설계

책임을 찾고 책임을 수행할 적절한 객체를 찾아 책임을 할당하는 방식(정보 전문가 패턴)으로 협력을 설계하는 방법.

구현이 아닌 책임에 집중할 수 있게 해준다.

### 메시지가 객체를 결정하게 하자

1. 객체가 최소한의 퍼블릭 인터페이스를 가질 수 있게 된다.
2. 객체가 충분히 추상적인 인터페이스를 가질 수 있게 된다.

### 중요한 것은 객체의 상태가 아니라 행동

객체가 가질 수 있는 상태, 즉 인스턴스 변수들은 객체가 수행하는 행동(책임)을 결정하고 나서야 결정할 수 있다. 상태는 단지 행동을 수행하기 위한 재료일 뿐이다.

### 역할을 찾는 게 먼저

객체지향 설계는 (1) 메시지를 수신할 수 있는 익명의 역할을 찾고, (2) 실제 그 역할을 수행할 수 있는 객체를 선택하는 방식으로 진행된다.

### 역할은 유연하고 재사용 가능한 협력을 만든다

특정 객체가 아니라 역할을 기준으로 협력을 구현하면, 동일한 책임을 수행하는 역할을 기반으로 두 개 이상의 협력을 하나로 통합할 수 있다.
즉 불필요한 중복 코드를 제거할 수 있으며 협력이 더 유연해진다.

### 역할의 구현

추상 클래스와 인터페이스를 사용하는 것이 일반적이다.

- ex) 추상 클래스로 구현된 DiscountPolicy 를 상속받은 AmountDiscountPolicy, PercentDiscountPolicy 모두 ‘할인 요금 계산’ 이라는 책임을 수행할 수 있고, 영화 예매 도메인 협력에 참여할 수 있다.

### 객체 vs 역할

협력에 적합한 책임을 수행하는 대상이 한 종류라면 객체로 간주한다. 여러 종류의 객체들이 참여할 수 있다면 역할이라고 부르자.

### 역할은 협력을 추상화한다

역할은 동일한 협력을 수행하는 객체들을 추상화할 수 있기 때문에 중요하다.
역할을 기준으로 협력을 구현하면, 추상화의 장점인 (1) 설계도 단순화 (2) 유연한 설계를 얻을 수 있다.

### 역할은 객체의 페르소나다

- 연극 안에서 배역을 연기하는 배우 = 협력 안에서 역할을 수행하는 객체
- 동일한 역할을 수행하는 객체들은 서로 대체 가능하다.
- 객체는 여러 역할을 가질 수 있지만, 특정한 협력 안에서는 오직 하나의 역할만이 보여진다는 점을 잊지말자. 객체는 다양한 역할을 가질 수 있다.

<br>

## 발제

책에서 책임이 중요하다고 여러 번 이야기합니다. 책임이 중요한 이유와 책임 주도 설계가 개발 및 유지보수 측면에서 어떻게 유용할지에 대해서 정리하는 겸 이야기해보면 좋을 것 같습니다.